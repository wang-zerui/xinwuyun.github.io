# ç¬¬å››éƒ¨åˆ†ç½‘ç»œå±‚

è´Ÿè´£è®¡ç®—æœºé—´ä¼ è¾“åˆ†ç»„

> 1. IPv4åœ°å€ï¼šAã€Bã€Cã€Då’ŒEç±»åœ°å€ã€æ©ç ã€å­ç½‘å’Œè¶…ç½‘çš„æ¦‚å¿µ
> 1. å­ç½‘åˆ’åˆ†ã€å­ç½‘çš„åœ°å€èŒƒå›´ã€åœ°å€èšåˆ
> 1. *NAT*çš„æ¦‚å¿µ
> 1. IPv6åœ°å€

> å¯èƒ½ç»è¿‡å¤šä¸ªç½‘ç»œï¼Œæ•°æ®é“¾è·¯å±‚è´Ÿè´£åœ¨åŒä¸€ç½‘ç»œï¼ˆé“¾è·¯ï¼‰ä¸Šä¸¤ä¸ªç³»ç»Ÿä¹‹é—´ä¼ è¾“åˆ†ç»„
>
> ç½‘ç»œå±‚ä¿è¯æ¯ä¸€åˆ†ç»„ä»æºåˆ°å®ƒçš„æœ€åç›®çš„åœ°

ç½‘ç»œå±‚å¢åŠ ä¸€ä¸ª**å¤´éƒ¨**

åŒ…å«æ¥è‡ªä¸Šä¸€å±‚åˆ†ç»„çš„å‘é€æ–¹ä¸æ¥æ”¶æ–¹é€»è¾‘åœ°å€ï¼Œå¦‚æœåˆ†ç»„ç»è¿‡å› ç‰¹ç½‘ä¼ è¾“ï¼Œè¿˜éœ€è¦**å¯»å€ç³»ç»Ÿæ¥è¯†åˆ«**æºä¸ç›®çš„åœ°å€

å½“è‹¥å¹²ä¸ªç‹¬ç«‹çš„ç½‘ç»œï¼ˆé“¾è·¯ï¼‰è¿æ¥åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªäº’è”ç½‘æ—¶ï¼Œ**è·¯ç”±å™¨æˆ–äº¤æ¢æœº**å¯¹åˆ†ç»„è¿›è¡Œè·¯ç”±é€‰æ‹©åˆ°è¾¾å®ƒçš„æœ€ç»ˆç›®çš„ã€‚

# CH19é€»è¾‘å¯»å€

ç½‘ç»œå±‚ä¸Šçš„é€šä¿¡æ˜¯ä¸»æœºåˆ°ä¸»æœºã€‚

[TOC]



## IPv4åœ°å€

æ˜¯ä¸€ä¸ª32ä½åœ°å€ï¼Œ*å”¯ä¸€åœ°ä¸é€šç”¨åœ°*å®šä¹‰äº†ä¸€ä¸ª**è¿æ¥åœ¨å› ç‰¹ç½‘ä¸Šçš„è®¾å¤‡**

### åœ°å€ç©ºé—´

$2^{32}$

### æ ‡è®°æ³•

äºŒè¿›åˆ¶æ ‡è®°æ³•å’Œç‚¹åˆ†åè¿›åˆ¶æ ‡ä»·æ³•

![image-20211224172959993](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/34385980575ddd6f2060a49a449b959b-image-20211224172959993-165fb7.png)

### åˆ†ç±»å¯»å€

#### **åœ°å€ç±»å’Œåœ°å€å—**

ABCDEç±»

![image-20211224173717909](/Users/xinwuyun/Library/Application Support/typora-user-images/image-20211224173717909.png)

+ Aç±»ï¼šä¸ºå…·æœ‰å¤§é‡ä¸»æœºçš„æœºæ„è®¾è®¡
+ Bç±»ï¼šä¸ºå¯èƒ½å…·æœ‰æ•°ä¸‡å°ä¸»æœºæˆ–è·¯ç”±å™¨çš„ä¸­å‹ç»„ç»‡æœºæ„æ‰€è®¾è®¡çš„
+ Cç±»ï¼šä¸ºå…·æœ‰å°‘é‡ä¸»æœºæˆ–è·¯ç”±å™¨çš„å°å‹ç»„ç»‡æœºæ„æ‰€è®¾è®¡çš„
+ Dç±»ï¼šä¸ºå¤šæ’­è®¾è®¡
+ Eç±»ï¼šä¸ºå°†æ¥ä¿ç•™

#### **ç½‘ç»œå·ä¸ä¸»æœºå·**

ABCåœ°å€åˆ†ä¸ºç½‘ç»œå·ï¼ˆnetidï¼‰å’Œä¸»æœºå·ï¼ˆhostedï¼‰

> æ³¨æ„ï¼šåªæœ‰ABCæœ‰

![image-20211224195041663](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/a46a5b8bfc0e84fe0e74e43f6ebbb77c-image-20211224195041663-deddbe.png)

#### **æ©ç **mask

æ— ç±»åŸŸé—´è·¯ç”±é€‰æ‹©ï¼ˆClassless Interdomain Rounting CIDRï¼‰

![image-20211224200112174](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/1ab317809291c167da5e97bccc550646-image-20211224200112174-8dda3d.png)

#### **å­ç½‘åŒ–**subnetting

å­ç½‘åŒ–å¯å°†è¿™äº›åœ°å€åˆ’åˆ†ä¸ºå‡ ä¸ªç±»ç»„ï¼Œå¹¶èµ‹äºˆæ¯ä¸€ç»„ä¸ºè¾ƒå°çš„ç½‘ç»œï¼ˆç§°ä¸ºå­ç½‘ï¼Œsubnetï¼‰

åœ¨å­ç½‘æ©ç ä¸­åœ¨å¢åŠ 1çš„ä¸ªæ•°ã€‚

#### **è¶…ç½‘åŒ–**supernetting

ä¸€ä¸ªç»„ç»‡æœºæ„èƒ½å°†Cç±»åœ°å€æ„æˆæ›´å¤§èŒƒå›´çš„åœ°å€ç©ºé—´ã€‚ä¸€ä¸ªç»„ç»‡æœºæ„èƒ½å°†å‡ ä¸ªCç±»å—åœ°å€æ„æˆæ›´å¤§èŒƒå›´çš„åœ°å€ç©ºé—´â€”â€”è¶…ç½‘

+ éœ€è¦ç”³è¯·ä¸€ç»„Cç±»åœ°å€å—è€Œä¸æ˜¯ä»…ä»…ä¸€ä¸ª
  + æ¯”å¦‚éœ€è¦1000ä¸ªåœ°å€ï¼Œéœ€è¦4ä¸ªCç±»åœ°å€å—
+ è¶…ç½‘åŒ–æ˜¯åœ¨æ©ç ä¸­**å‡å°1çš„ä¸ªæ•°**

> æ— ç±»å¯»å€æ²¡æœ‰è¶…ç½‘åŒ–çš„éœ€è¦

#### **åœ°å€è€—å°½**

ABç±»è€—å°½ï¼ŒCç±»å¯¹å¤šæ•°ä¸­ç­‰è§„æ¨¡çš„ç»„ç»‡æœºæ„è¿˜æ˜¯å¤ªå°

### æ— ç±»å¯»å€

classless addressing

æ²¡æœ‰ç±»ä½†ä»æä¾›åœ°å€å—

#### **åœ°å€å—**

æŒ‰éœ€åˆ†é…

#### **é™åˆ¶æ¡ä»¶**

1. å—ä¸­çš„åœ°å€å¿…é¡»è¿ç»­
2. ä¸€ä¸ªå—ä¸­åœ°å€çš„ä¸ªæ•°æ˜¯2çš„æ•´æ•°æ¬¡æ¬¡å¹‚
3. å—çš„èµ·å§‹åœ°å€å¿…é¡»èƒ½è¢«å—çš„ä¸ªæ•°æ•´é™¤

#### **æ©ç **

å—åœ°å€å®šä¹‰ï¼šå—ä¸­ä»»ä¸€åœ°å€å’Œæ©ç 

ä¸€ä¸ªæ©ç 32ä½ï¼Œnä½1å’Œ32-nä½0ã€‚

ç”¨æ–œæ ï¼ˆCIDRæ ‡è®°æ³•ï¼‰

> ç”¨*x.y.z.t/n*æ¥å®šä¹‰

åœ°å€å’Œ/nå¯ä»¥å®Œå…¨å®šä¹‰æ•´ä¸ªåœ°å€å—ï¼ˆèµ·å§‹åœ°å€ã€æœ€ååœ°å€å’Œåœ°å€ä¸ªæ•°ï¼‰

#### ğŸŒ°

![image-20211224205910199](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/8be510416e676e899e0233e2bfad553d-image-20211224205910199-965ff4.png)

#### **æ— ç±»å¯»å€.ç½‘ç»œåœ°å€**

**å—çš„èµ·å§‹åœ°å€**ï¼Œå®šä¹‰è¯¥ç»„ç»‡æœºæ„çš„ç½‘ç»œã€‚

> **èµ·å§‹åœ°å€**æ˜¯è·¯ç”±å™¨ç”¨æ¥å°†æŠ¥æ–‡å‘é€åˆ°è¯¥**ç»„ç»‡æœºæ„å¤–éƒ¨**çš„åœ°å€ã€‚

![](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/09a07b0af6312d9eb9b4ce774144b8ee-image-20211224211313142-ac6d1b.png)

è·¯ç”±å™¨æœ‰ä¸¤ä¸ªåœ°å€ï¼Œä¸€ä¸ªå±äºè·å‡†çš„å—ï¼Œå¦ä¸€ä¸ªå±äºè·¯ç”±å™¨å¦ä¸€ç«¯æ‰€åœ¨çš„ç½‘ç»œ

> èµ·å§‹åœ°å€ä¸åˆ†é…ç»™ä»»ä½•è®¾å¤‡ï¼Œç”¨åšå‘äº’è”ç½‘å…¶ä»–éƒ¨åˆ†è¡¨ç¤ºè¯¥ç½‘ç»œçš„**ç½‘ç»œåœ°å€**

#### **ç‰¹æ®ŠIPåœ°å€**

![image-20211225092652217](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/25/efc259b8a06731063e5158e957101bb7-image-20211225092652217-70eaf0.png)

#### **å±‚æ¬¡ç»“æ„**

IPä¹Ÿæœ‰å±‚æ¬¡ç»“æ„

#### **äºŒçº§å±‚æ¬¡ç»“æ„**x.y.z.t/nï¼Œå·¦è¾¹nä½æ˜¯ç½‘ç»œå‰ç¼€ï¼Œåç¼€æ˜¯ä¸»æœºåœ°å€ã€‚

![image-20211224212410521](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/a35fae20d9ec201afd72342259d9716b-image-20211224212410521-bece43.png)

#### **ä¸‰çº§å±‚æ¬¡ç»“æ„**ï¼šå­ç½‘åŒ–

#### **å¤šçº§å±‚æ¬¡ç»“æ„**

![image-20211224220629123](/Users/xinwuyun/Library/Application Support/typora-user-images/image-20211224220629123.png)

![image-20211224220640949](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/c9a2408a2846b8acf1bf56fa5004ca00-image-20211224220640949-47f4f9.png)



## ç½‘ç»œåœ°å€è½¬æ¢

Network Address Translation NAT

### ä¸“ç”¨åœ°å€å’Œå…¨çƒåœ°å€

å†…éƒ¨æ‹¥æœ‰å¤§é‡çš„åœ°å€ï¼Œå¤–éƒ¨åªæœ‰å°‘é‡çš„åœ°å€ã€‚å†…éƒ¨é€šä¿¡ç”¨å†…ç½‘åœ°å€ï¼Œå¤–éƒ¨é€šä¿¡ç”¨å¤–ç½‘åœ°å€ã€‚

![image-20211224222922388](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/5ef875a1b8ae32f733c3a56d09c789fc-image-20211224222922388-3a43ee.png)

é€šè¿‡ä¸€å°è¿è¡ŒNATè½¯ä»¶çš„è·¯ç”±å™¨ï¼Œ**ç«™ç‚¹å¿…é¡»åªæœ‰ä¸€æ¡ä¸å…¨å±€å› ç‰¹ç½‘ç›¸è¿çš„é“¾è·¯ã€‚**

+ ä¸“ç”¨åœ°å€åªèƒ½ç”¨äºä¸€ä¸ªæœºæ„å†…éƒ¨é€šä¿¡ï¼Œä¸èƒ½ç”¨äºå’Œå› ç‰¹ç½‘ä¸Šçš„ä¸»æœºé€šä¿¡
+ ä¸“ç”¨åœ°å€åªèƒ½ç”¨åš**æœ¬åœ°åœ°å€**ï¼Œ**å› ç‰¹ç½‘è·¯ç”±å™¨**ä¸Šï¼Œå¯¹ç›®çš„åœ°æ˜¯ä¸“ç”¨åœ°å€çš„æ•°æ®æŠ¥**ä¸€å¾‹ä¸è½¬å‘**
+ é‡‡ç”¨ä¸“ç”¨IPåœ°å€çš„ç½‘ç»œç§°ä¸ºä¸“ç”¨äº’è”ç½‘ã€æœ¬åœ°äº’è”ç½‘æˆ–ä¸“ç”¨ç½‘ã€‚
+ ä¸“ç”¨IPåœ°å€ä¹Ÿç§°ä¸º**å¯é‡ç”¨åœ°å€**

### **åœ°å€è½¬æ¢**

å¤–å‘çš„åˆ†ç»„éƒ½é€šè¿‡**NATè·¯ç”±å™¨**å‘é€å‡ºæ¥ï¼Œ**è¯¥è·¯ç”±å™¨**å…¨çƒNATåœ°å€æ¥æ›¿ä»£åˆ†ç»„ä¸­çš„æºåœ°å€ã€‚æ‰€æœ‰è¾“å…¥çš„åˆ†ç»„ä¹Ÿè¦é€šè¿‡NATè·¯ç”±å™¨ï¼Œ

![image-20211224223254394](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/24/433caa106cf52768ecd3d6af51fb6128-image-20211224223254394-5c912c.png)

### **è½¬æ¢è¡¨**

+ **ä½¿ç”¨ä¸€ä¸ªIPåœ°å€**
+ **è¿ç”¨IPåœ°å€æ± **
+ **åŒæ—¶è¿ç”¨IPåœ°å€å’Œç«¯å£å·**NAPTï¼ˆNetwork Address and Port Translationï¼‰
  + æŠŠæºIPåœ°å€å’ŒTCPï¼ˆæˆ–UDPï¼‰ç«¯å£å·éƒ½è¿›è¡Œè½¬æ¢
  + ä¸“ç”¨ç½‘å†…ä¸åŒçš„æºIPåœ°å€éƒ½è½¬æ¢ä¸ºåŒæ ·çš„**å…¬ç½‘IPåœ°å€**
  + å¯¹**æºä¸»æœºé‡‡ç”¨çš„TCPç«¯å£å·**ï¼Œéƒ½**è½¬æ¢ä¸ºä¸åŒçš„æ–°çš„ç«¯å£å·**
+ æœºåˆ¶çš„ç‰¹æ®Šæ€§ï¼ˆä¸æ™®é€šè·¯ç”±å™¨çš„***åŒºåˆ«***ï¼‰
  + æ™®é€šè·¯ç”±å™¨è½¬å‘æ—¶ä¸æ”¹å˜æºIPåœ°å€å’Œç›®çš„åœ°å€ï¼›NATè·¯ç”±å™¨ä¼šæ”¹å˜æºåœ°å€æˆ–ç›®çš„åœ°å€
  + æ™®é€šè·¯ç”±å™¨åœ¨è½¬å‘åˆ†ç»„æ—¶å·¥ä½œåœ¨ç½‘ç»œå±‚ï¼ŒNAPTè·¯ç”±å™¨è¦æŸ¥çœ‹å’Œè½¬æ¢è¿è¾“å±‚çš„ç«¯å£å·

![image-20211225101045867](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/25/a90f4c259b8948900271856c1bd53ffe-image-20211225101045867-c28dfe.png)





## IPv6

IPv6åœ°å€ç”±16å­—èŠ‚ï¼ˆ8ä½ç»„ï¼‰ç»„æˆï¼Œé•¿åº¦128ä½ã€‚

> ä¸€ä¸ªIPv6åœ°å€çš„é•¿åº¦æ˜¯128ä½

### å†’å·æ ‡è®°æ³•

![image-20211225102939721](/Users/xinwuyun/Library/Application Support/typora-user-images/image-20211225102939721.png)

### ç¼©çŸ­

IPv6è®¸å¤šæ•°å­—æ˜¯0ã€‚ä¸€ä¸ªéƒ¨åˆ†ä¸­å¼€å§‹çš„0å¯ä»¥çœç•¥ã€‚å…¨0å¯ä»¥ç§»å»

![image-20211225103816428](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/25/dda5db1137727b03afff73e0f2c4a079-image-20211225103816428-320a1e.png)

### åœ°å€ç©ºé—´

![image-20211225104348702](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/25/a1201ea70b2493b6f774d81534a7f62b-image-20211225104348702-a43e44.png)

**å•æ’­åœ°å€unicast address**

**å¤šæ’­åœ°å€multicast address**

**ä»»æ’­åœ°å€anycast address**

**ä¿ç•™åœ°å€ reserved address**

**æœªæŒ‡æ˜åœ°å€ unspecified address**

+ ç¯å›åœ°å€
+ å…¼å®¹åœ°å€
+ æ˜ å°„åœ°å€

**æœ¬åœ°åœ°å€ **

**æœ¬åœ°é“¾è·¯åœ°å€ Link local address**     



192.168.1.2/24



































