# 3æ•°æ®é“¾è·¯æ§åˆ¶

+ æˆå¸§0
+ æµé‡æ§åˆ¶
+ å·®é”™æ§åˆ¶
+ åè®®0
+ æ— å™ªå£°é€šé“
+ æœ‰å™ªå£°é€šé“
+ é«˜çº§æ•°æ®é“¾è·¯æ§åˆ¶HDLC
+ ç‚¹åˆ°ç‚¹PPP
+ PPPoE (äº†è§£)

## ä¸€ã€æˆå¸§

+ æˆå¸§æ–¹å¼
+ é˜²æ­¢æ··æ·†
  + å­—èŠ‚å¡«å……
  + ä½å¡«å……

å°†ä¸€ç»„æ¯”ç‰¹ä½ç»„æˆå¸§ï¼Œä¸€éå¸§å’Œå¸§ä¹‹é—´å¯ä»¥è¯†åˆ«ã€‚

**å¸§**

å°†ä¸€æ¡ä»æºç«¯åˆ°ç›®çš„ç«¯çš„æŠ¥æ–‡åˆ†ç¦»å¼€ã€‚

+ Fixed-size framing
+ Variable-Size Framing

## æˆå¸§æ–¹å¼

+ å›ºå®šå¤§å°ï¼šATMç½‘ç»œ
+ å¯å˜é•¿åº¦
  + é¢å‘å­—ç¬¦
  + é¢å‘ä½

![image-20211218111549064](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/18/758ee7bf70666946cbef2e03ef8cac4c-image-20211218111549064-cb9f12.png)

ä»ä¸Šä¸€å±‚æ¥çš„æ•°æ®ï¼šä»¥å­—èŠ‚å½¢å¼

flagæ ‡è®°ä¸€å¸§çš„å¼€å§‹å’Œç»“æŸ

### å­—èŠ‚å¡«å……

å½“æ•°æ®ä¸­å­˜åœ¨ä¸€ä¸ª**æ ‡è®°å­—ç¬¦ï¼ˆflagï¼‰æˆ–è€…æ¢ä¹‰å­—ç¬¦**æ—¶ï¼Œæ·»åŠ ä¸€ä¸ªé¢å¤–å­—èŠ‚çš„è¿‡ç¨‹

![image-20211218111812978](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/18/e571da6a6692070c51dd0acf3f4fc9b5-image-20211218111812978-a5ba50.png)

![image-20211218111855703](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/18/bd49ec82cb144a55b2e2ef871e5d72c9-image-20211218111855703-17cb47.png)

## æµé‡æ§åˆ¶å’Œå·®é”™æ§åˆ¶



é€šå¸¸ä¸€èµ·ç§°ä¸ºæ•°æ®é“¾è·¯æ§åˆ¶

+ Flow Control
+ Error Control

## æµé‡æ§åˆ¶

**ä¸€ç³»åˆ—ç¨‹åºï¼Œ**ç”¨æ¥é™åˆ¶å‘é€æ–¹åœ¨ç­‰åˆ°ç¡®è®¤ä¹‹å‰å‘é€çš„æ•°æ®æ•°é‡ï¼Œä½¿ä¸ä¼šè¶…è¿‡æ¥æ”¶èƒ½åŠ›

æ¥æ”¶æ–¹æœ‰ä¸€å®šç¼“å­˜ï¼Œå¯ä»¥å­˜ä¸€éƒ¨åˆ†é€æ­¥æ¶ˆè´¹

æ•°æ®é“¾è·¯å±‚çš„å·®é”™æ§åˆ¶åŸºäºè‡ªåŠ¨é‡å¤è¯·æ±‚ï¼ˆARQï¼‰é‡ä¼ æ•°æ®

## 5ç§åè®®



> ä¸¤ç§å¸§ï¼š
>
> 1. ç¡®è®¤å¸§:ACKæ¥æ”¶â€”â€”å‘é€
> 2. å¦å®šç¡®è®¤å¸§ï¼šNAKâ€”â€”è¡¨æ˜ç¡®è®¤æ•°æ®æ”¶åˆ°ä½†æ˜¯æœ‰é”™è¯¯è¦æ±‚é‡å‘

æå¸¦æŠ€æœ¯

![image-20211218114732199](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/18/b74f9c883ffbaab7ce95bb41470d2405-image-20211218114732199-ff332d.png)

## æ— å™ªå£°ä¿¡é“

+ æœ€ç®€å•åè®®
+ åœæ­¢ç­‰å¾…åè®®

ä¸é€‚ç”¨å·®é”™æ§åˆ¶

## æœ‰å™ªå£°ä¿¡é“

+ åœæ­¢ç­‰å¾…ARQ
+ å›é€€Nå¸§ARQ
+ é€‰æ‹©é‡å¤ARQ

## æœ€ç®€å•åè®®

+ æ²¡æœ‰æµé‡æ§åˆ¶
+ æ²¡æœ‰å·®é”™æ§åˆ¶

![image-20211219101837968](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/3499fbd3259308d578f51a4906d5cb3d-image-20211219101837968-02715c.png)

+ å‘é€æ–¹
  + äº‹ä»¶ï¼šä»ç½‘ç»œå±‚å‘å‡ºè¯·æ±‚
  + å‘é€å¥½å¤šå¸§
+ æ¥æ”¶æ–¹
  + äº‹ä»¶ï¼šç½‘ç»œå±‚ä¼ æ¥æ•°æ®

### ç®—æ³•

#### å‘é€æ–¹

```c
while(true){            //æ°¸è¿œé‡å¤
  WaitForEvent();			 // ç­‰å¾…äº‹ä»¶
  if(Event(Request)){		// åŒ…
    getData();				//å‘
    MakeFrame();
    SendFrame();
  }
}
```

#### æ¥æ”¶æ–¹

1. æ°¸è¿œé‡å¤
2. ç­‰å¾…äº‹ä»¶
3. æ¥å—

![image-20211219102640018](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/c99defff58a7ecb3eec41486aa4180f5-image-20211219102640018-0cec61.png)

### ğŸŒ°

![image-20211219102757267](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/d09c9268a4be4d80c1234e4a6dfd504f-image-20211219102757267-06de10.png)



+ å‘é€æ–¹ä¸è€ƒè™‘æ¥æ”¶æ–¹æ˜¯å¦æ¥å—åˆ°

## åœç­‰åè®®

+ æ²¡æœ‰å·®é”™æ§åˆ¶
+ æœ‰æµé‡æ§åˆ¶

![image-20211219103005726](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/ebf1a20cf5eb31c9699b5d6e7c0fa070-image-20211219103005726-b95614.png)

### æµé‡æ§åˆ¶çš„å®ç°

å‘é€æ–¹å‘é€ä¸€å¸§åï¼Œåªæœ‰æ”¶åˆ°ACKæ‰ä¼šå‘é€ä¸‹ä¸€ä¸ª

```c
while(true){
	canSend = true;
  WaitForEvent();
  if(Event(RequestToSend) and canSend)
  {
    GetData();
    MakeFrame();
    SendFrame();
    canSend = false;
    
  }
  WaitForEvent();
  if(Event(ArrivalNotification))
  {
    ReceiveFrame();
    canSend();
  }
}
```

**æ¥æ”¶æ–¹**

![image-20211219103514071](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/7df0d5bbd7fc4e82f0bbfc2b88d0a3d8-image-20211219103514071-068ac9.png)

+ æ•°æ®æ¥è‡ªç‰©ç†å±‚
+ å¤„ç†
+ æ•°æ®äº¤ç»™ç½‘ç»œå±‚

### ğŸŒ°

æµé‡å›¾

![image-20211219103738887](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/50cdaa1e3f5248e716f0b6ad2fca2feb-image-20211219103738887-f9c761.png)

> è¦æ±‚ä¼šç”»ï¼Œä¸ç”¨è¿™ä¹ˆæ¼‚äº®

## åœç­‰ARQ

+ åœæ­¢ç­‰å¾…
+ ARQ è‡ªåŠ¨é‡å‘

> åœç­‰åè®®æ²¡æœ‰é‡å‘

+ æœ‰å·®é”™æ§åˆ¶
+ ä¿ç•™å·²å‘é€å¸§çš„å‰¯æœ¬
+ **é‡ä¼ å®šæ—¶å™¨**åˆ°æœŸåé‡ä¼ è¿™ä¸ªå¸§å®ç°å·®é”™æ£€æµ‹
+ ä½¿ç”¨åºåˆ—å·ä¸ºæ¯ä¸€ä¸ªå¸§ç¼–å·ï¼ˆå·®é”™æ§åˆ¶éœ€è¦ï¼‰
+ åºåˆ—å·åŸºäºæ¨¡2è¿ç®—
+ ACKç¡®è®¤å¸§**ä¹Ÿä¼šä¸¢å¤±**ï¼Œå› æ­¤**ä¹Ÿéœ€è¦åºåˆ—å·**
+ ACKç¼–å·æ˜¯æœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€å¸§çš„ç¼–å·ï¼ˆæ¨¡2è¿ç®—ï¼‰

![image-20211219110651629](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/1a51c983191c2a71562f087997283635-image-20211219110651629-777425.png)

> ä¸€æ¬¡ä¸€å¸§

+ Snï¼š*çª—å£*
+ å‘é€æ–¹äº‹ä»¶
  + ç½‘ç»œå±‚è¯·æ±‚
  + ç‰©ç†å±‚é€šçŸ¥ï¼šACK
  + è¶…æ—¶
+ æ¥æ”¶æ–¹äº‹ä»¶
  + ç‰©ç†å±‚é€šçŸ¥

### ç®—æ³•

```c
Sn = 0;
canSend = true;
while(true){
  WaitForEvent();
  if(Event(RequestToSend) and canSend){
    GetData();
    MakeFrame(Sn);
    StoreFrame(Sn);
    StartFrame(Sn);
    StartTimer();
    Sn = Sn+1;
    canSend = false;
  }
  WatiForEvent();
  if(Event(ArrivalNotication)){
    ReceiveFrame(ackNo);
    if(not corrupted and ackNo == Sn)
    {
      stopTimer();
      purgeFrame(Sn-1);   //æ¸…é™¤å‰¯æœ¬
      canSend = true;
    }
  }
  if(Event(Timeout)){
    StartTimer();
    ResendFrame(Sn-1);
  }
}

```



![image-20211219111511444](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/c894ea6bf29f14e3b28e915040118ca0-image-20211219111511444-7924ed.png)

+ åºåˆ—å·ä¸åŒ¹é…ä¹Ÿä¼šå‘é€ACKï¼Œä½†æ˜¯åºå·ä¸åŠ 1ï¼Œè¿˜æ˜¯è¿™ä¸€å¸§
+ è¿™é‡Œèƒ½çœ‹å‡ºè¶…æ—¶
  + è·¯ä¸Šä¸¢å¤±
  + åˆ°äº†ä½†å·®é”™

### ğŸŒ°

![image-20211219111701582](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/a366d9622ddcff998c4866e539c24985-image-20211219111701582-4fbd7d.png)

> éƒ½æ˜¯æ¨¡2

![image-20211219111806926](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/eed0adf45ef03eca5fa222ce799a1fde-image-20211219111806926-23b4f9.png)

![image-20211219112133398](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/b6ef63f1a26dde96779ee96529f2d18c-image-20211219112133398-dad17b.png)

## å›é€€Nå¸§ARQ

+ åºåˆ—å·æ¨¡$2^m$ï¼Œå…¶ä¸­mä¸ºåºåˆ—å·å­—æ®µé•¿åº¦
+ **æ»‘åŠ¨çª—å£**ï¼šå®šä¹‰å‘é€æ–¹å’Œæ¥æ”¶æ–¹å…³å¿ƒçš„åºåˆ—å·èŒƒå›´

![image-20211219113616968](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/cd4aa612ac0a85f3e32c17cebb307dec-image-20211219113616968-9656cc.png)

> åªæœ‰å‘é€çª—å£å†…çš„æ‰èƒ½å‘é€

+ SnæŒ‡å‘ä¸‹ä¸€ä¸ªå‘é€çš„å¸§
+ çª—å£å¤§å°$2^m-1$
+ æ”¶åˆ°æŸå¸§å
  + å·¦è¾¹ç•Œå³ç§»
  + å³è¾¹ç•Œå³ç§»

### å‘é€çª—å£

+ Sf
+ Sn
+ Ssize å°äº$2^m$ä¸€èˆ¬$2^m-1$

+ å½“æœ‰æ•ˆç¡®è®¤åˆ°è¾¾æ—¶
  + å‘é€çª—å£æ»‘åŠ¨
  + ä¸€ä¸ªæˆ–å¤šä¸ªå¸§æ—¶éš™

### æ¥æ”¶çª—å£

![image-20211219115008044](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/67720cb162618b3fde8450b3ebb45f0d-image-20211219115008044-e442de.png)

+ $R_n$å®šä¹‰äº†ä¸€ä¸ªå¤§å°ä¸º1çš„æ¥æ”¶çª—å£
+ **æ­£ç¡®çš„**å¸§åˆ°è¾¾æ—¶ï¼Œæ¥æ”¶çª—å£æ»‘åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ—¶éš™

### ç¡®è®¤

+ å½“ä¸€ä¸ªå¸§å®‰å…¨æœ‰åºåˆ°è¾¾æ—¶ï¼Œæ¥æ”¶æ–¹å‘é€è‚¯å®šçš„ç¡®è®¤
+ å¦‚æœä¸€ä¸ªå¸§è¢«ç ´åæˆ–æ¬¡åºé¢ å€’
  + æ¥æ”¶æ–¹ä¸å“åº”
  + ä¸¢å¼ƒåæ¥çš„æ‰€æœ‰å¸§
  + çŸ¥é“æ”¶åˆ°ä¸€ä¸ª**æœŸå¾…å¸§**
+ æ¥æ”¶æ–¹ä¸å“åº”ä½¿å¾—ä¸è¢«ç¡®è®¤å¸§çš„å®šæ—¶å™¨è¿‡æœŸï¼Œå‘é€æ–¹ä»æ­¤å¸§å¼€å§‹é‡å‘æ‰€æœ‰å¸§
+ æ¥æ”¶æ–¹å‘é€ä¸€ä¸ª**ç´¯ç§¯ç¡®è®¤**

![image-20211219155832727](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/c0b77effb5e1beaae3554b94e1de84ca-image-20211219155832727-94a436.png)



![image-20211219155842640](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/29f37d8baee5aafdc3bad4b6eb9518df-image-20211219155842640-4d0379.png)

è§‚å¯Ÿå·¦è¾¹æƒ…å†µï¼Œå¦‚æœå·¦è¾¹çª—å£å¤§å°æ˜¯$2^m$ï¼Œåˆ™ä¼šå‘é€Frame3ï¼Œç„¶åå¦‚æœä¾ç„¶è¶…æ—¶ï¼Œåˆ™å‘é€Frame0ï¼Œè€Œæ­¤æ—¶æ¥æ”¶çª—å£ä¹Ÿæƒ³è¦Frame0ï¼Œè¿™æ ·ä¸è¡Œã€‚

> æ‰€ä»¥ï¼Œå‘é€æ–¹çª—å£å¿…é¡»å°äº$2^m$
>
> æ¥æ”¶æ–¹çª—å£åªèƒ½æ˜¯1

![image-20211219161340437](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/7c49f868095e0d200d4a91f8ad0af61c-image-20211219161340437-86cc0c.png)

![image-20211219161347759](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/e7166cd13f8dc2fe1f73d6717e179b16-image-20211219161347759-465be5.png)

æ¥æ”¶æ–¹

![image-20211219161449139](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/aaf38a17c0b76ccaa5cb82f9a203f7d4-image-20211219161449139-43c152.png)

![image-20211219161649144](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/0cb2976e0d765a4c1726464819d29f66-image-20211219161649144-d2252d.png)

<center>ç´¯ç§¯ç¡®è®¤</center>

### ğŸŒ°

**ACKä¸¢å¤±**

![image-20211219161802441](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/2ca202e976deb617e2df3d231f67d3c5-image-20211219161802441-b245aa.png)

> ä¸¢å¤±çš„ACKä¸éœ€è¦é‡å‘

**å‘é€å¸§ä¸¢å¤±**

![image-20211219162331766](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/636d814caa7c7ca89e2feca4f82a5f18-image-20211219162331766-38c66c.png)



### é—®é¢˜

+ æ¥æ”¶æ–¹åªæœ‰ä¸€ä¸ªå˜é‡ï¼Œä¸èƒ½è§£å†³å¤±åºé—®é¢˜
+ åœ¨**æœ‰å™ªå£°ä¿¡é“æ•ˆç‡ä½ä¸‹**ï¼Œéœ€è¦é‡å‘å¤šä¸ªå¸§

**é€‰æ‹©é‡å¤ARQ**

+ çª—å£å°ºå¯¸æ›´å°$2^{m-1}$

+ æ¥æ”¶çª—å£ä¸å‘é€çª—å£**ä¸€æ ·å¤§**

  

## é€‰æ‹©é‡ä¼ ARQ

### å‘é€çª—å£

![image-20211219163428139](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/441983fdf57c50295f7a16d556bbd3c4-image-20211219163428139-d732db.png)

### æ¥æ”¶çª—å£

![image-20211219163522402](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/537ab3aa0925cbaf3df78841793df9b3-image-20211219163522402-1eeb8b.png)

![image-20211219163725228](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/0f22914bf0d9749bca1e484754614e2e-image-20211219163725228-2f0f09.png)

### çª—å£å¤§å°

$2^{m-1}$

![image-20211219163832861](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/a3e49e9a70e988d67a9b8aa2ff145e4c-image-20211219163832861-75b261.png)

![image-20211219165157515](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/fa278a322df43eaffafc3fdfeb5bdda9-image-20211219165157515-eff8e9.png)

![image-20211219165343705](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/f695fbe66742b01195c182db78d1128f-image-20211219165343705-6a698b.png)![image-20211219165409948](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/9550be7d963335bbad78db3305c5fd6f-image-20211219165409948-f32288.png)

![image-20211219171520822](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/e93a451ec9061cd959a8ea97eaf52403-image-20211219171520822-a59669.png)

![image-20211219171531455](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/169a19731703503837b71fa764f2d8f8-image-20211219171531455-1f11ee.png)

![image-20211219164926187](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/b3bf339a0370e47b6aeefafc79fee541-image-20211219164926187-072676.png)

+ å®šæ—¶å™¨å¯åŠ¨ã€é‡å¯å’Œåœæ­¢
+ ä¸€ç»„è¿ç»­å¸§åˆ°è¾¾ä¸”ä»çª—å£èµ·ç‚¹å¼€å§‹åˆ™å¯ä»¥å‘ç½‘ç»œå±‚äº¤ä»˜
+ æ¯ä¸ªè€Œçª—å£ä½ç½®åªå‘é€ä¸€ä¸ªNAKï¼Œå¹¶æŒ‡å‘çª—å£ç¬¬ä¸€ä¸ªæ—¶éš™
+ **æ•°æ®äº¤ä»˜åˆ°ç½‘ç»œå±‚**æ‰å‘ACK

## æå¸¦ï¼ˆäº†è§£ï¼‰

![image-20211219213724568](https://cdn.jsdelivr.net/gh/xinwuyun/pictures@main/2021/12/19/67d339e3716c6986ec06e3d1d839198c-image-20211219213724568-1ab153.png)



## HDLCé«˜çº§æ•°æ®é“¾è·¯æ§åˆ¶åè®®(éé‡ç‚¹)

High-level Data Link Control

+ é¢å‘ä½000
